(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{344:function(a,t,s){a.exports=s.p+"assets/img/image-20240325224344544.18bbda2a.png"},345:function(a,t,s){a.exports=s.p+"assets/img/image-20240325225023368.d681d2c8.png"},435:function(a,t,s){"use strict";s.r(t);var e=s(9),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"jvm-参数查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jvm-参数查看"}},[a._v("#")]),a._v(" JVM 参数查看")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 可以查看 jvm 默认配置，例如 size_t MaxHeapSize = 130862280 {product} {default}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Xmx200m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+PrintFlagsInitial")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-version")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 命令行参数，影响了 jvm 配置 size_t MaxHeapSize = 209715200  {product} {command line}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Xmx200m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+PrintFlagsFinal")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-version")]),a._v("\n")])])]),t("h3",{attrs:{id:"arthas-强烈建议学会"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#arthas-强烈建议学会"}},[a._v("#")]),a._v(" arthas-强烈建议学会")]),a._v(" "),t("p",[a._v("Arthas 是一款线上监控诊断产品，通过全局视角实时查看应用 load、内存、gc、线程的状态信息，并能在不修改应用代码的情况下，对业务问题进行诊断，包括查看方法调用的出入参、异常，监测方法执行耗时，类加载信息等，大大提升线上问题排查效率。")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://arthas.aliyun.com/doc/",target:"_blank",rel:"noopener noreferrer"}},[a._v("arthas"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"jps"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jps"}},[a._v("#")]),a._v(" jps")]),a._v(" "),t("p",[a._v("Java 提供的一个显示当前所有 java进程 pid的命令")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -l 显示类名称 -m 显示传给 main 的参数 -v 显示传给虚拟机的参数")]),a._v("\njps "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v("\njps "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-lmv")]),a._v("\n")])])]),t("h3",{attrs:{id:"jinfo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jinfo"}},[a._v("#")]),a._v(" jinfo")]),a._v(" "),t("p",[a._v("用于显示 java 进程的 vm 配置 和 Java System Properties。或者修改某项 vm 配置")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 打印 VM flags and system properties")]),a._v("\njinfo "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pid"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# to print the value of the named VM flag ，-flag <name>")]),a._v("\njinfo "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-flag")]),a._v(" OldSize "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60739")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#  to enable or disable the named VM flag，-flag [+|-]<name>   ")]),a._v("\n\n")])])]),t("h3",{attrs:{id:"jstack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jstack"}},[a._v("#")]),a._v(" jstack")]),a._v(" "),t("p",[a._v("用于生成 java 进程中所有线程的堆栈信息，用于诊断死锁及线程阻塞等问题。")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("jstack "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("40695")]),a._v("\n")])])]),t("h3",{attrs:{id:"jmap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jmap"}},[a._v("#")]),a._v(" jmap")]),a._v(" "),t("p",[a._v("jmap：Java虚拟机自带的命令行工具，可以生成JVM中堆内存的Dump文件，用于分析堆内存的使用情况。排查内存泄漏等问题。")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# dump 成文件，包队 class 信息和堆信息")]),a._v("\njmap -dump:live,format"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("b,file"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("heap.bin "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pid"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 打印 java 对象占用信息")]),a._v("\njmap -histo:live,file"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/tmp/histo.data "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pid"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),t("h3",{attrs:{id:"jhat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jhat"}},[a._v("#")]),a._v(" jhat")]),a._v(" "),t("p",[a._v("使用 "),t("strong",[a._v("jmap")]),a._v(" 可以生成 Java 堆的 dump 文件，使用 jhat 命令将dump文件转成 html 的形式然后创建了 server，然后通过 http 访问可以查看堆情况。")]),a._v(" "),t("p",[a._v("将 dump 文件下载到本地使用 "),t("a",{attrs:{href:"https://github.com/oracle/visualvm",target:"_blank",rel:"noopener noreferrer"}},[a._v("VisualVM"),t("OutboundLink")],1),a._v(" 分析。")]),a._v(" "),t("h3",{attrs:{id:"jstat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jstat"}},[a._v("#")]),a._v(" jstat")]),a._v(" "),t("p",[a._v("jstat：查看 Java 虚拟机 gc 命令。")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("jstat -"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("option"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-h"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("lines"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("vmid"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("interval"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("count"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看支持的 option")]),a._v("\njstat "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-options")]),a._v(" \n")])])]),t("p",[a._v("::: tips")]),a._v(" "),t("p",[t("strong",[a._v("C")]),a._v(" 结尾代表 capacity 或者 count，表示某个指标的容量或次数。")]),a._v(" "),t("p",[t("strong",[a._v("U")]),a._v(" 结尾代表 use，表示使用了多少。")]),a._v(" "),t("p",[t("strong",[a._v("T")]),a._v(" 结尾代表 time，表示用时。")]),a._v(" "),t("p",[a._v(":::")]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("jstat -gc")])])]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 隔 1s 打印 gc 信息，打印 gc 次数，每 5 行打印头信息")]),a._v("\njstat "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-gc")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h5")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60739")]),a._v(" 1s "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:s(344),alt:"image-20240325224344544"}})]),a._v(" "),t("p",[a._v("可以看到 s0,s1,eden,old,meraspace 多大，用了多少。还可以看到 gc 的次数和发生事件。总共 gc 次数和 gc 时间。")]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("jstat -gcutil")])])]),a._v(" "),t("p",[a._v("查看 s0,s1,eden,old,meraspace 使用百分比及 gc 次数和时间。")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("jstat "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-gcutil")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h5")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60739")]),a._v(" 1s "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:s(345),alt:"image-20240325225023368"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);