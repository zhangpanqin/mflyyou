(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{393:function(s,t,a){"use strict";a.r(t);var e=a(9),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据类型"}},[s._v("#")]),s._v(" 数据类型")]),s._v(" "),t("p",[t("strong",[s._v("Table 8.2. Numeric Types")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("Name")]),s._v(" "),t("th",[s._v("Storage Size")]),s._v(" "),t("th",[s._v("Description")]),s._v(" "),t("th",[s._v("Range")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[t("code",[s._v("bigint")])]),s._v(" "),t("td",[s._v("8 bytes")]),s._v(" "),t("td",[s._v("large-range integer")]),s._v(" "),t("td",[s._v("-9223372036854775808 to +9223372036854775807")])]),s._v(" "),t("tr",[t("td",[t("code",[s._v("smallserial")])]),s._v(" "),t("td",[s._v("2 bytes")]),s._v(" "),t("td",[s._v("small autoincrementing integer")]),s._v(" "),t("td",[s._v("1 to 32767")])]),s._v(" "),t("tr",[t("td",[t("code",[s._v("serial")])]),s._v(" "),t("td",[s._v("4 bytes")]),s._v(" "),t("td",[s._v("autoincrementing integer")]),s._v(" "),t("td",[s._v("1 to 2147483647")])]),s._v(" "),t("tr",[t("td",[t("code",[s._v("bigserial")])]),s._v(" "),t("td",[s._v("8 bytes")]),s._v(" "),t("td",[s._v("large autoincrementing integer")]),s._v(" "),t("td",[s._v("1 to 9223372036854775807")])])])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" test_bigserial"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   id BIGSERIAL "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- Sequence and defined type")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" SEQUENCE "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),s._v(" test_bigserial_id_seq"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- Table Definition")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"public"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_bigserial"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(" int8 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" nextval"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test_bigserial_id_seq'")]),s._v("::regclass"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("By assigning the "),t("code",[s._v("SERIAL")]),s._v(" pseudo-type to the "),t("code",[s._v("id")]),s._v(" column, PostgreSQL performs the following:")]),s._v(" "),t("ul",[t("li",[s._v("First, create a sequence object and set the next value generated by the sequence as the default value for the column.")]),s._v(" "),t("li",[s._v("Second, add a "),t("code",[s._v("NOT NULL")]),s._v(" constraint to the "),t("code",[s._v("id")]),s._v(" column because a sequence always generates an integer, which is a non-null value.")]),s._v(" "),t("li",[s._v("Third, assign the owner of the sequence to the "),t("code",[s._v("id")]),s._v(" column; as a result, the sequence object is deleted when the "),t("code",[s._v("id")]),s._v(" column or table is dropped")])]),s._v(" "),t("h2",{attrs:{id:"权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限"}},[s._v("#")]),s._v(" 权限")]),s._v(" "),t("h3",{attrs:{id:"角色"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#角色"}},[s._v("#")]),s._v(" 角色")]),s._v(" "),t("p",[s._v("本地数据库 postgresql 为超级管理员")]),s._v(" "),t("p",[s._v("postgresql 中的 user 和 role 是同一个东西。user 可以登录，都可以使用 "),t("code",[s._v("CREATE ROLE <rolename>;")])]),s._v(" "),t("p",[s._v("将一个 role a grant to role b, b 会继承 a 的权限。b 是 a 的一个 member")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("PostgreSQL 提供了 set role 设置 child 以 parent 身份进行数据库操作，意味着每个由 child 创建的表的 owner 都是同一个 parent。")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看 role")]),s._v("\n\\du\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_roles"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建 role 可以登录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 常用 option SUPERUSER，CREATEDB，CREATEROLE，INHERIT，[ ENCRYPTED ] PASSWORD 'password'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" ROLE name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" ROLE service_order "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" LOGIN PASSWORD "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 修改 role")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" ROLE service_order "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" INHERIT SUPERUSER"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除 role")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" ROLE service_order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询某个 role 下有哪些子 role")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" pr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rolname parent_role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pr2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rolname son_role\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" pg_roles pr\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INNER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" pg_auth_members pam "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" pr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("oid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("roleid\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INNER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" pg_roles pr2 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" pr2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("oid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"member"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" pr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rolname "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'postgres'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- role1 获得 group_role 的权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" group_role "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" role1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REVOKE")]),s._v(" group_role "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" role1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"权限-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限-2"}},[s._v("#")]),s._v(" 权限")]),s._v(" "),t("p",[s._v("postgresql 中创建的表，默认只有这个表的 owner(默认是创建者) 可以访问")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("CRETAE  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t1 OWNER "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 将某个 role 的 owner 权限全部转移，然后")]),s._v("\nREASSIGN OWNED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" doomed_role "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" successor_role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" OWNED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" doomed_role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- repeat the above commands in each database of the cluster")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" ROLE doomed_role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 把新建表的所有权限赋予 database_role")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SCHEMA")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" database_role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 把 public 下现有的表所有权限赋予 database_role")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SCHEMA")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" database_role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"aws-postgres"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aws-postgres"}},[s._v("#")]),s._v(" aws postgres")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://aws.amazon.com/cn/premiumsupport/knowledge-center/rds-aurora-postgresql-clone-master-user/",target:"_blank",rel:"noopener noreferrer"}},[s._v("创建一个最大权限的 role"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("aws postgres 默认创建了一个超级管理员用于它自身数据库维护。")]),s._v(" "),t("p",[t("strong",[s._v("rds_superuser")]),s._v(" 角色拥有 RDS 数据库实例的最大权限。")]),s._v(" "),t("h2",{attrs:{id:"基础操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基础操作"}},[s._v("#")]),s._v(" 基础操作")]),s._v(" "),t("h3",{attrs:{id:"docker-启动-postgresql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-启动-postgresql"}},[s._v("#")]),s._v(" docker 启动 postgresql")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 colima ，本地可以执行 docker 命令")]),s._v("\ncolima start\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull postgres:14.3-alpine\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create fly-postgres-data "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" fly-postgres "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("POSTGRES_USER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("postgres "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("POSTGRES_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("POSTGRES_DB")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sample "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v(":5432 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" fly-postgres-data:/var/lib/postgresql/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" postgres:14.3-alpine\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container stop fly-postgres "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" fly-postgres "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" fly-postgres-data\n\n\npsql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" localhost "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-U")]),s._v(" postgres "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" postgres\n")])])]),t("h3",{attrs:{id:"psql-安装及链接数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#psql-安装及链接数据库"}},[s._v("#")]),s._v(" Psql 安装及链接数据库")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("brew "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" libpq\nbrew "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--force")]),s._v(" libpq\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# psql postgres://username:password@host:port/dbname")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# psql -U username -h hostname -p port -d dbname")]),s._v("\npsql postgres://postgres:123456@localhost:5432/sample\npsql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" localhost "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-U")]),s._v(" postgres "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" sample\n\n")])])]),t("h3",{attrs:{id:"psql-操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#psql-操作"}},[s._v("#")]),s._v(" psql 操作")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 显示数据库下表的信息")]),s._v("\n\\d\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 显示某个表的表结构")]),s._v("\n\\d tablename\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 显示索引")]),s._v("\n\\di\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 自动补全，两次 tab")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看用户信息")]),s._v("\n\\du\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看表的访问权限")]),s._v("\n\\z\n")])])]),t("h3",{attrs:{id:"pg-gump"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pg-gump"}},[s._v("#")]),s._v(" pg_gump")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pg_dump --no-owner --data-only --column-inserts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--table")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("table_pattern "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--schema")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public postgres://user:password@host:port/db_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /tmp/table_pattern.sql\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("psql postgres://user:password@host:port/db_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /tmp/table_pattern.sql\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);