<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mysql 架构 | Mflyyou</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/mflyyou/favicon.ico">
    <meta name="description" content="张攀钦的笔记">
    <meta name="theme-color" content="#3eaf7c">
    
    <link rel="preload" href="/mflyyou/assets/css/0.styles.b6588544.css" as="style"><link rel="preload" href="/mflyyou/assets/js/app.1ebce3ec.js" as="script"><link rel="preload" href="/mflyyou/assets/js/5.060b7482.js" as="script"><link rel="preload" href="/mflyyou/assets/js/2.337a644b.js" as="script"><link rel="preload" href="/mflyyou/assets/js/7.09832819.js" as="script"><link rel="preload" href="/mflyyou/assets/js/13.4af4aae9.js" as="script"><link rel="prefetch" href="/mflyyou/assets/js/10.13d2098d.js"><link rel="prefetch" href="/mflyyou/assets/js/100.6b5f6658.js"><link rel="prefetch" href="/mflyyou/assets/js/101.1309bb11.js"><link rel="prefetch" href="/mflyyou/assets/js/102.a670d5e1.js"><link rel="prefetch" href="/mflyyou/assets/js/103.a654de66.js"><link rel="prefetch" href="/mflyyou/assets/js/104.3ee8ac1b.js"><link rel="prefetch" href="/mflyyou/assets/js/105.f865a9da.js"><link rel="prefetch" href="/mflyyou/assets/js/106.3db4bc18.js"><link rel="prefetch" href="/mflyyou/assets/js/107.86df4273.js"><link rel="prefetch" href="/mflyyou/assets/js/108.b7e9e440.js"><link rel="prefetch" href="/mflyyou/assets/js/11.0bf0370f.js"><link rel="prefetch" href="/mflyyou/assets/js/12.fa71d27f.js"><link rel="prefetch" href="/mflyyou/assets/js/14.1489cead.js"><link rel="prefetch" href="/mflyyou/assets/js/15.2ee76f25.js"><link rel="prefetch" href="/mflyyou/assets/js/16.84f457ea.js"><link rel="prefetch" href="/mflyyou/assets/js/17.5d4f1dec.js"><link rel="prefetch" href="/mflyyou/assets/js/18.c6b9fecb.js"><link rel="prefetch" href="/mflyyou/assets/js/19.1035b370.js"><link rel="prefetch" href="/mflyyou/assets/js/20.def9a443.js"><link rel="prefetch" href="/mflyyou/assets/js/21.26682c03.js"><link rel="prefetch" href="/mflyyou/assets/js/22.62a9c6b0.js"><link rel="prefetch" href="/mflyyou/assets/js/23.515399df.js"><link rel="prefetch" href="/mflyyou/assets/js/24.6bf3a2cd.js"><link rel="prefetch" href="/mflyyou/assets/js/25.a7fc332e.js"><link rel="prefetch" href="/mflyyou/assets/js/26.acc05f74.js"><link rel="prefetch" href="/mflyyou/assets/js/27.df62034b.js"><link rel="prefetch" href="/mflyyou/assets/js/28.a17f9051.js"><link rel="prefetch" href="/mflyyou/assets/js/29.bf9b8bf2.js"><link rel="prefetch" href="/mflyyou/assets/js/3.172e0e5c.js"><link rel="prefetch" href="/mflyyou/assets/js/30.c1b15405.js"><link rel="prefetch" href="/mflyyou/assets/js/31.1ca60331.js"><link rel="prefetch" href="/mflyyou/assets/js/32.c60f993e.js"><link rel="prefetch" href="/mflyyou/assets/js/33.cd2ec5a7.js"><link rel="prefetch" href="/mflyyou/assets/js/34.2ae655a8.js"><link rel="prefetch" href="/mflyyou/assets/js/35.39f0314c.js"><link rel="prefetch" href="/mflyyou/assets/js/36.76ac8750.js"><link rel="prefetch" href="/mflyyou/assets/js/37.92fa0b22.js"><link rel="prefetch" href="/mflyyou/assets/js/38.1e81e861.js"><link rel="prefetch" href="/mflyyou/assets/js/39.e45c223b.js"><link rel="prefetch" href="/mflyyou/assets/js/4.17a133fa.js"><link rel="prefetch" href="/mflyyou/assets/js/40.850524c7.js"><link rel="prefetch" href="/mflyyou/assets/js/41.d904d47b.js"><link rel="prefetch" href="/mflyyou/assets/js/42.74644fc4.js"><link rel="prefetch" href="/mflyyou/assets/js/43.d9b5b83a.js"><link rel="prefetch" href="/mflyyou/assets/js/44.6c61b2f6.js"><link rel="prefetch" href="/mflyyou/assets/js/45.66700c63.js"><link rel="prefetch" href="/mflyyou/assets/js/46.dc39c419.js"><link rel="prefetch" href="/mflyyou/assets/js/47.0ddd4e71.js"><link rel="prefetch" href="/mflyyou/assets/js/48.053c6f31.js"><link rel="prefetch" href="/mflyyou/assets/js/49.6f5f4490.js"><link rel="prefetch" href="/mflyyou/assets/js/50.dd55f743.js"><link rel="prefetch" href="/mflyyou/assets/js/51.12a7ecf3.js"><link rel="prefetch" href="/mflyyou/assets/js/52.826138a9.js"><link rel="prefetch" href="/mflyyou/assets/js/53.9d5ff3e8.js"><link rel="prefetch" href="/mflyyou/assets/js/54.29061e3d.js"><link rel="prefetch" href="/mflyyou/assets/js/55.d814cfd2.js"><link rel="prefetch" href="/mflyyou/assets/js/56.c7059609.js"><link rel="prefetch" href="/mflyyou/assets/js/57.68dbe6db.js"><link rel="prefetch" href="/mflyyou/assets/js/58.06bbd4a4.js"><link rel="prefetch" href="/mflyyou/assets/js/59.3c39689b.js"><link rel="prefetch" href="/mflyyou/assets/js/6.939cdf3c.js"><link rel="prefetch" href="/mflyyou/assets/js/60.0c3fa548.js"><link rel="prefetch" href="/mflyyou/assets/js/61.34c71010.js"><link rel="prefetch" href="/mflyyou/assets/js/62.ccb9cf2e.js"><link rel="prefetch" href="/mflyyou/assets/js/63.ad9dc6aa.js"><link rel="prefetch" href="/mflyyou/assets/js/64.2ac503ea.js"><link rel="prefetch" href="/mflyyou/assets/js/65.d9e32710.js"><link rel="prefetch" href="/mflyyou/assets/js/66.9ad8e53d.js"><link rel="prefetch" href="/mflyyou/assets/js/67.d0e9b568.js"><link rel="prefetch" href="/mflyyou/assets/js/68.131208e9.js"><link rel="prefetch" href="/mflyyou/assets/js/69.152fc2aa.js"><link rel="prefetch" href="/mflyyou/assets/js/70.a6a4c0d9.js"><link rel="prefetch" href="/mflyyou/assets/js/71.35aa5807.js"><link rel="prefetch" href="/mflyyou/assets/js/72.1b63f1ed.js"><link rel="prefetch" href="/mflyyou/assets/js/73.d613ca64.js"><link rel="prefetch" href="/mflyyou/assets/js/74.b49eac90.js"><link rel="prefetch" href="/mflyyou/assets/js/75.cb165e12.js"><link rel="prefetch" href="/mflyyou/assets/js/76.0710e669.js"><link rel="prefetch" href="/mflyyou/assets/js/77.52c1a01a.js"><link rel="prefetch" href="/mflyyou/assets/js/78.c748b2b5.js"><link rel="prefetch" href="/mflyyou/assets/js/79.c2d56fac.js"><link rel="prefetch" href="/mflyyou/assets/js/8.0139ba8e.js"><link rel="prefetch" href="/mflyyou/assets/js/80.b4badf91.js"><link rel="prefetch" href="/mflyyou/assets/js/81.a2e99bcd.js"><link rel="prefetch" href="/mflyyou/assets/js/82.5c0e5ecc.js"><link rel="prefetch" href="/mflyyou/assets/js/83.290d422f.js"><link rel="prefetch" href="/mflyyou/assets/js/84.f26844dd.js"><link rel="prefetch" href="/mflyyou/assets/js/85.c226a65d.js"><link rel="prefetch" href="/mflyyou/assets/js/86.f9fd95fe.js"><link rel="prefetch" href="/mflyyou/assets/js/87.cdb9b919.js"><link rel="prefetch" href="/mflyyou/assets/js/88.5f3630e8.js"><link rel="prefetch" href="/mflyyou/assets/js/89.43523bf0.js"><link rel="prefetch" href="/mflyyou/assets/js/9.5bef5ca8.js"><link rel="prefetch" href="/mflyyou/assets/js/90.e2cb20cd.js"><link rel="prefetch" href="/mflyyou/assets/js/91.4f92828a.js"><link rel="prefetch" href="/mflyyou/assets/js/92.b42ed060.js"><link rel="prefetch" href="/mflyyou/assets/js/93.fa96fb9d.js"><link rel="prefetch" href="/mflyyou/assets/js/94.ef7b58a2.js"><link rel="prefetch" href="/mflyyou/assets/js/95.f452a910.js"><link rel="prefetch" href="/mflyyou/assets/js/96.36d19357.js"><link rel="prefetch" href="/mflyyou/assets/js/97.1e0d9cd1.js"><link rel="prefetch" href="/mflyyou/assets/js/98.c1326730.js"><link rel="prefetch" href="/mflyyou/assets/js/99.2401c0fe.js">
    <link rel="stylesheet" href="/mflyyou/assets/css/0.styles.b6588544.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mflyyou/" class="home-link router-link-active"><!----> <span class="site-name">Mflyyou</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mflyyou/java/base/java-messy-code.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/mflyyou/go/base/go-command.html" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mflyyou/springboot/project-sumary/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/mflyyou/tcp-ip/http/http-cors-jsonp/" class="nav-link">
  TCP/IP
</a></div><div class="nav-item"><a href="/mflyyou/dev-tools/asdf/" class="nav-link">
  开发工具
</a></div><div class="nav-item"><a href="/mflyyou/devops/docker/" class="nav-link">
  DevOps
</a></div> <a href="https://github.com/zhangpanqin/mflyyou" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mflyyou/java/base/java-messy-code.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/mflyyou/go/base/go-command.html" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mflyyou/springboot/project-sumary/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/mflyyou/tcp-ip/http/http-cors-jsonp/" class="nav-link">
  TCP/IP
</a></div><div class="nav-item"><a href="/mflyyou/dev-tools/asdf/" class="nav-link">
  开发工具
</a></div><div class="nav-item"><a href="/mflyyou/devops/docker/" class="nav-link">
  DevOps
</a></div> <a href="https://github.com/zhangpanqin/mflyyou" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/docker/" class="sidebar-link">Docker</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Terraform</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/terraform/" class="sidebar-link">Terraform</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>AWS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/aws/" class="sidebar-link">Aws</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/linux/linux-base.html" class="sidebar-link">Linux 基础</a></li><li><a href="/mflyyou/devops/linux/vim.html" class="sidebar-link">Vim</a></li><li><a href="/mflyyou/devops/linux/ssh.html" class="sidebar-link">SSH</a></li><li><a href="/mflyyou/devops/linux/redirect-pipeline.html" class="sidebar-link">重定向和管道流</a></li><li><a href="/mflyyou/devops/linux/debian.html" class="sidebar-link">Debian</a></li><li><a href="/mflyyou/devops/linux/shell-base.html" class="sidebar-link">shell 基础</a></li><li><a href="/mflyyou/devops/linux/shell-example.html" class="sidebar-link">实用的 shell 列子</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>auth0</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/auth0/auth0.html" class="sidebar-link">auth0</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/nginx/nginx-base.html" class="sidebar-link">Nginx-包教包会-入门</a></li><li><a href="/mflyyou/devops/nginx/nginx-config.html" class="sidebar-link">Nginx-性能优化</a></li><li><a href="/mflyyou/devops/nginx/nginx-performance.html" class="sidebar-link">Nginx-包教包会-进阶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/database/mysql/" aria-current="page" class="sidebar-link">Mysql 基础</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-arch.html" aria-current="page" class="active sidebar-link">Mysql 架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mysql-架构说明" class="sidebar-link">Mysql 架构说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mysql-工作流程" class="sidebar-link">Mysql 工作流程</a></li></ul></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mysql-存储文件介绍" class="sidebar-link">Mysql 存储文件介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#查看-mysql-数据文件的目录" class="sidebar-link">查看 Mysql 数据文件的目录</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#系统表空间" class="sidebar-link">系统表空间</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#独立表空间" class="sidebar-link">独立表空间</a></li></ul></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#innodb-存储引擎架构" class="sidebar-link">InnoDB 存储引擎架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#buffer-pool" class="sidebar-link">Buffer Pool</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#binlog" class="sidebar-link">binlog</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#redo-log" class="sidebar-link">redo log</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#两阶段提交" class="sidebar-link">两阶段提交</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#分布式事务" class="sidebar-link">分布式事务</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#undo-log" class="sidebar-link">undo log</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mvcc" class="sidebar-link">MVCC</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#数据存储介绍" class="sidebar-link">数据存储介绍</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#表空间" class="sidebar-link">表空间</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#段" class="sidebar-link">段</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#区" class="sidebar-link">区</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#页" class="sidebar-link">页</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#行" class="sidebar-link">行</a></li></ul></li></ul></li><li><a href="/mflyyou/devops/database/mysql/mysql-index.html" class="sidebar-link">Mysql索引</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-lock-and-transaction.html" class="sidebar-link">Mysql 事务和锁</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-explain.html" class="sidebar-link">Explain 查看执行计划</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-limit.html" class="sidebar-link">Mysql Limit 限制</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-data-types.html" class="sidebar-link">Mysql 数据类型</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-account-management.html" class="sidebar-link">Mysql 用户权限管理</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-backup-recovery.html" class="sidebar-link">Mysql数据备份与恢复</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>PostgreSql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/database/postgresql/postgresql.html" class="sidebar-link">PostgreSQL 基础</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Elasticsearch</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/elasticsearch/es.html" class="sidebar-link">Elasticsearch</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/redis/redis.html" class="sidebar-link">Redis 基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/vue/vue-depoly.html" class="sidebar-link">你不知道的 SpringBoot 与 Vue 部署解决方案</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mysql-架构"><a href="#mysql-架构" class="header-anchor">#</a> Mysql 架构</h1> <h2 id="mysql-架构说明"><a href="#mysql-架构说明" class="header-anchor">#</a> Mysql 架构说明</h2> <p><img src="/mflyyou/assets/img/mysql-architecture.a92561fb.png" alt="img"></p> <p>上图为 Mysql 8.0 官网架构图。Mysql 是一个 C/S 架构的程序。</p> <p>Mysql 的 Server 端内部又又可以分为 <code>server</code> 和 <code>存储引擎</code> 两部分。我们查询数据，一般是 server 层和存储引擎打交道，然后存储引擎再给我们数据文件系统打交道，从里面找出我们需要的数据。</p> <h3 id="mysql-工作流程"><a href="#mysql-工作流程" class="header-anchor">#</a> Mysql 工作流程</h3> <p><img src="/mflyyou/assets/img/b843a63ac8c3b1dc07c8dd5d63b98107.2cbcc01c.png" alt="img"></p> <ol><li>当一个客户端向服务端发送连接请求后，MySQL Server 会从线程池中分配一个线程来和客户端进行连接，以后该客户端的请求都会被分配到该线程上。如果这个链接（jdbc 连接）空闲 8 个小时，Mysql 会断掉这个链接。<code>wait_timeout</code> 控制。</li> <li>当我们执行查询语句时，如果命中缓存直接返回查询数据。如果没有命中缓存，SQL 解析，SQL 优化生成执行计划，然后 server 层调用存储引擎层进行数据查询，其中 server 层和存储引擎层可能会多次打交道把数据查询出来。</li> <li>存储引擎查询索引或者表数据文件，得到数据返回给 server 层，然后 server 层返回给 client。</li></ol> <p>Mysql 将数据储存在硬盘上，为了提高查询速度，比较好的做法是将索引数据和一部分热数据（经常访问的数据）放到内存中（Mysql 的 <strong>Buffer Poll</strong>）。</p> <p>当检索数据的时候，Mysql 通过索引查找，就可以知道数据在磁盘哪块了，从硬盘对应位置读取对应的数据到内存中返回给 server 层。</p> <h2 id="mysql-存储文件介绍"><a href="#mysql-存储文件介绍" class="header-anchor">#</a> Mysql 存储文件介绍</h2> <h3 id="查看-mysql-数据文件的目录"><a href="#查看-mysql-数据文件的目录" class="header-anchor">#</a> 查看 Mysql 数据文件的目录</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%datadir%'</span><span class="token punctuation">;</span>
</code></pre></div><p>linux 下一般存储位置就是 <code>/var/lib/mysql/</code> 。</p> <h3 id="系统表空间"><a href="#系统表空间" class="header-anchor">#</a> 系统表空间</h3> <p>系统表空间是所有表共享的，它保存了数据表结构，事务信息 等</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'innodb_data_file_path%'</span>
<span class="token comment">-- ibdata1:12M:autoextend</span>
</code></pre></div><h3 id="独立表空间"><a href="#独立表空间" class="header-anchor">#</a> 独立表空间</h3> <p><strong>Mysql 8.0 是默认开启独立表空间的</strong>，默认每张表使用一个文件进行保存数据和索引</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查看是否开启独立表空间配置</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%innodb_file_per_table%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------+-------+</span>
<span class="token operator">|</span> Variable_name         <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------+-------+</span>
<span class="token operator">|</span> innodb_file_per_table <span class="token operator">|</span> <span class="token keyword">ON</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------+-------+</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>独立表空间是指每张表单独用一个文件储存每张表对应的表结构、数据和索引，文件扩展名为 ibd。</p> <p>每个数据库会有一个对应目录用于保存当前数据库中的数据文件</p></div> <p>比如我有一个 sandbox 数据库，这个库里创建了两个表 order 和 user。</p> <p>那么 <code>/var/lib/mysql/sandbox</code> 存储的就是这个 sandbox 数据库的数据。</p> <div class="language-txt extra-class"><pre class="language-txt"><code>ls -l /var/lib/mysql/sandbox/
-rw-r----- 1 mysql mysql 131072 Mar 23 15:27 order.ibd
-rw-r----- 1 mysql mysql 163840 Mar 23 15:12 user.ibd
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>当我们在某个数据库中创建一张表时，除了在系统表空间生成元数据和表结构，也会在对应的数据库目录下，新建一个 tablename.ibd 文件。</p></div> <h2 id="innodb-存储引擎架构"><a href="#innodb-存储引擎架构" class="header-anchor">#</a> InnoDB 存储引擎架构</h2> <p><img src="/mflyyou/assets/img/image-20240324141110463.2f7b37c9.png" alt="image-20240324141110463"></p> <h3 id="buffer-pool"><a href="#buffer-pool" class="header-anchor">#</a> Buffer Pool</h3> <p><code>Buffer Poll</code> 是主存中的一个区域，缓存 InnoDB 访问过的表和索引数据。在专用服务器上，高达 80% 的物理内存通常分配给缓冲池。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Buffer Pool 是一片连续的内存空间，然后按照默认的 <code>16KB</code> 的大小划分出一个个的页， Buffer Pool 中的页就叫做缓存页。</p> <p>当查询数据时，InnoDB 是会把整个页的数据加载到 Buffer Pool 中。因为，通过索引只能定位到磁盘中的页，而不能定位到页中的一条记录。将页加载到 Buffer Pool 后，再通过页里的页目录去定位到某条具体的记录。</p></div> <p>LRU（Least recently used）算法保证了频繁访问的数据一直留在 Buffer Pool 中，而一些很少访问的数据在某些时机淘汰掉，从而保证 Buffer Pool 不会因为满了而导致无法再缓存新的数据，同时还能保证常用数据留在 Buffer Pool 中。</p> <p>当我们要修改的数据在 <code>Buffer Poll</code> 中，直接修改缓存页，在落盘就行了。</p> <p>但是有的时候，我们修改的页不在 <code>Buffer Poll</code> 中，如果没有 change buffer，InnoDB 会将数据所在页加载到<code>Buffer Poll</code> ，修改，再落盘。为了提高效率，引入了 change buffer，想将修改操作写入 redo log 中，而不必加载数据。当再次读取到这页数据时，将 change buffer 中的页和数据页合并，达到数据一致性效果。</p> <p><strong>Change Buffer</strong> 它应用在**非唯一普通索引页（non-unique secondary index page）。</p> <h3 id="binlog"><a href="#binlog" class="header-anchor">#</a> binlog</h3> <p>binlog 是 server 层的，不管那个存储引擎都会有 binlog。Mysql 主从复制和备份都是依靠 binlog。</p> <p><code>binlog</code> 日志有三种格式，可以通过 <code>binlog_format</code> 参数指定。</p> <ul><li><strong>statement</strong>，会记录所有执行成功 DDL 和 DML（不包括 select 语句）操作，包括<code>UPDATE和DELETE</code>操作影响行数为 0 的情况。</li> <li><strong>row</strong>，会记录所有执行成功 DDL 和 DML（不包括 select 语句）操作，<code>UPDATE和DELETE</code>操作影响行数为 0 的不会记录。</li> <li><strong>mixed</strong>，用 <strong>row</strong> 时符合 <strong>row</strong> 规则，用 <strong>statement</strong> 符合 <strong>statement</strong> 规则</li></ul> <p>binlog_format 指定 <code>statement</code>，记录的内容是<code>SQL</code>语句原文，比如执行一条 <code>update a set update_time=now() where id=1</code>，记录的内容如下。但是 now() 会导致数据不一样。</p> <p>为了解决这个问题，有 row，记录的是数据的修改值。</p> <p>如果一个 SQL，修改了全表数据，row 模式会非常大，同步的时候消耗更多的 io 资源，延迟也高。</p> <p>为了解决这个问题，引入了 mixed ，MySQL 会判断这条 SQL 语句是否可能引起数据不一致，如果是，就用 row 格式，否则就用 statement 格式。</p> <h3 id="redo-log"><a href="#redo-log" class="header-anchor">#</a> redo log</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>redo log 保证了数据的持久性。属于 InnoDB。</p></div> <p><code>InnoDB</code> 存储引擎是以页为单位来管理存储空间。当 InnoDB 读取磁盘上的页数据到 Buffer Pool 中，修改了数据，将 Buffer Pool 中对应的页落盘。如果一条 SQL 修改的大量数据分布零散，当这些页都写入到磁盘时，随机 io 性能太拉。</p> <p>我们只是想持久化数据的修改，即使后来系统崩溃，在重启后也能把这种修改恢复过来。redo log 就是做这个的，提交事务的时候，它将我们修改的字段数据顺序写入到日志文件中，而不必将脏页持久化。</p> <p>写 redo log 的时候，实际先顺序写入到 Buffer Pool 中的 Log Buffer，当我们提交事务或者 Log Buffer 空间不足时，在讲 Log Buffer 落盘，页持久化了 redo log。</p> <h3 id="两阶段提交"><a href="#两阶段提交" class="header-anchor">#</a> 两阶段提交</h3> <p><code>redo log</code> 让 InnoDB 存储引擎拥有了崩溃恢复能力，保证数据的持久性</p> <p><code>binlog</code> 保证了 MySQL 集群架构的数据一致性。</p> <p>如果这两个日志逻辑不一样，会导致数据丢失或者没通过成功。</p> <p>为了解决两份日志之间的逻辑一致问题，<code>InnoDB</code>存储引擎使用<strong>两阶段提交</strong>方案。</p> <p>原理很简单，将 <code>redo log</code> 的写入拆成了两个步骤<code>prepare</code>和<code>commit</code>，这就是<strong>两阶段提交</strong>。</p> <p><img src="/mflyyou/assets/img/badecbaedbf1e38410e5686f7684852a.9e013d02.jpeg" alt="img"></p> <p>第一阶段提交，redo log 处于 prepare 状态落盘，然后 server 层写入 binlog （cache）。</p> <p>第二阶段提交，binlog 落盘，redo log 处于 commit 状态落盘。</p> <p>下面我们分析一下，两阶段提交的好处</p> <p>情景一，redo log 处于 prepare 状态时，如果写 bin log 失败了，那么更新失败，此时 redo log 没有 commit，bin log 也没有记录，两者的状态是一致的，没有问题。</p> <p>情景二，redo log 处于 prepare 状态时，写 bin log 成功，但是宕机导致 commit 失败了。此时 bin log 产生了记录，redo log 没有写入成功，数据暂时不一致。</p> <p>当 MySQL 重启时，会检查 redo log 中处于 prepare 状态的记录。在 redo log 中，记录了一个叫做 XID 的字段，这个字段在 bin log 中也有记录，MySQL 会通过这个 XID，如果在 bin log 中找到了，那么就 commit 这个 redo log，如果没有找到，说明 bin log 其实没有写成功，就放弃提交。</p> <h3 id="分布式事务"><a href="#分布式事务" class="header-anchor">#</a> 分布式事务</h3> <p>分布式事务是指一个全局事务中，有多个 mysql 参与的小事务组成一个大事务。</p> <p>XA 规范提出 2 个角色：</p> <ul><li>一个全局事务由多个小的事务组成，所以我们得在某个地方找一个总揽全局的家伙，这个家伙用于和各个小事务进行沟通，指导它们是提交还是回滚。这个家伙被称作事务协调器（Transaction Coordinator）</li> <li>管理一个小事务的家伙被称作事务管理器（Transaction Manager）。</li></ul> <p>此时 XA 规范中指出，要提交一个全局事务，必须分为 2 步：</p> <ul><li>Prepare 阶段：<strong>事务协调器</strong>通知<strong>事务管理器</strong> redo log 落盘。</li> <li>Commit 阶段：第一阶段都 ok，然后<strong>事务协调器</strong>通知<strong>事务管理器</strong>提交事务。</li></ul> <h4 id="mysql-中的-xa-事务"><a href="#mysql-中的-xa-事务" class="header-anchor">#</a> MySQL 中的 XA 事务</h4> <ul><li><code>XA {START|BEGIN} xid</code>：该语句用于开启一个 XA 事务，此时该 XA 事务处于 <code>ACTIVE</code> 状态。</li> <li><code>XA END xid</code>：在使用<code>XA START xid</code>开启了一个 XA 事务后，客户端就可以接着发送属于这个 XA 事务的各条语句，等所有语句都发送完毕后，就可以接着发送<code>XA END xid</code>来告知服务器由<code>xid</code>标识的 XA 事务的所有语句都输入完了。此时该 XA 事务处于<code>IDLE</code>状态。</li> <li><code>XA PREPARE xid</code>：对于处于<code>IDLE</code>状态的 XA 事务，应用程序就可以询问 MySQL 服务器是否准备好提交这个 XA 事务了，此时就可以给服务器发送<code>XA PREPARE xid</code>语句。当 MySQL 服务器收到此语句后，就需要做准备提交前的工作了，比如把该事务执行过程中所产生的 redo 日志刷新到磁盘等。此时 XA 事务处于<code>PREPARE</code>状态。</li> <li><code>XA COMMIT xid [ONE PHASE]</code>：对于处于<code>PREPARE</code>状态的 XA 事务，应用程序可以发送<code>XA COMMIT xid</code>来让 MySQL 服务器提交 XA 事务。如果此 XA 事务尚处于<code>IDEL</code>状态，那应用程序可以不发送<code>XA PREPARE xid</code>，而直接发送<code>XA COMMIT xid ONE PHASE</code>来让 MySQL 服务器直接提交事务即可。此 XA 事务处于<code>COMMITE</code>状态。</li> <li><code>XA ROLLBACK xid</code>：应用程序通过发送此语句来让 MySQL 服务器回滚 xid 所标识的事务。此时 XA 事务处于<code>ABORT</code>状态。</li> <li><code>XA RECOVER</code>：应用程序想看一下当前 MySQL 服务器上已经处于 Prepare 状态的 XA 事务有哪些，就可以发送该语句。</li></ul> <h3 id="undo-log"><a href="#undo-log" class="header-anchor">#</a> undo log</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>undo log 保证了数据的原子性。属于 InnoDB。</p></div> <p>undo log 是一种用于撤销回退的日志。在事务没提交之前，MySQL 会先记录更新前的数据到 undo log 日志文件里面，当事务回滚时，可以利用 undo log 来进行回滚。</p> <ul><li>在<strong>插入</strong>一条记录时，要把这条记录的主键值记下来，这样之后回滚时只需要把这个主键值对应的记录<strong>删掉</strong>就好了；</li> <li>在<strong>删除</strong>一条记录时，要把这条记录中的内容都记下来，这样之后回滚时再把由这些内容组成的记录<strong>插入</strong>到表中就好了；</li> <li>在<strong>更新</strong>一条记录时，要把被更新的列的旧值记下来，这样之后回滚时再把这些列<strong>更新为旧值</strong>就好了。</li></ul> <h4 id="undo-log-的作用"><a href="#undo-log-的作用" class="header-anchor">#</a> Undo Log 的作用</h4> <ol><li>Undo Log 用来记录每次修改之前的历史值，配合 Redo Log 用于故障恢复。</li> <li>事务回滚</li> <li>MVCC（Multi-Versioin Concurrency Control）</li></ol> <h3 id="mvcc"><a href="#mvcc" class="header-anchor">#</a> MVCC</h3> <p>事务 id 是由 Mysql 控制唯一且递增。</p> <p>对于 <code>读提交</code> 和 <code>可重复读</code> 隔离级别的事务来说，快照读是通过 Read View + undo log 来实现的，它们的区别在于创建 Read View 的时机不同：</p> <ul><li>「读提交」隔离级别是在每个 select 都会生成一个新的 Read View，也意味着，事务期间的多次读取同一条数据，前后两次读的数据可能会出现不一致，因为可能这期间另外一个事务修改了该记录，并提交了事务。</li> <li>「可重复读」隔离级别是启动事务时生成一个 Read View，然后整个事务期间都在用这个 Read View，这样就保证了在事务期间读到的数据都是事务启动前的记录。</li></ul> <p>这个 <code>ReadView</code> 中主要包含 4 个比较重要的内容：</p> <ul><li><code>m_ids</code>：表示在生成<code>ReadView</code>时当前系统中活跃的读写事务的<code>事务id</code>列表。</li> <li><code>min_trx_id</code>：表示在生成<code>ReadView</code>时当前系统中活跃的读写事务中最小的<code>事务id</code>，也就是<code>m_ids</code>中的最小值。</li> <li><code>max_trx_id</code>：表示生成<code>ReadView</code>时系统中应该分配给下一个事务的<code>id</code>值。</li> <li><code>creator_trx_id</code>：表示生成该<code>ReadView</code>的事务的<code>事务id</code>。</li></ul> <p>有了这个<code>ReadView</code>，这样在访问某条记录时，只需要按照下边的步骤判断记录的某个版本是否可见：</p> <ul><li>如果被访问版本的<code>trx_id</code>属性值与<code>ReadView</code>中的<code>creator_trx_id</code>值相同，意味着当前事务在访问它自己修改过的记录，所以该版本可以被当前事务访问。</li> <li>如果被访问版本的<code>trx_id</code>属性值小于<code>ReadView</code>中的<code>min_trx_id</code>值，表明生成该版本的事务在当前事务生成<code>ReadView</code>前已经提交，所以该版本可以被当前事务访问。</li> <li>如果被访问版本的<code>trx_id</code>属性值大于或等于<code>ReadView</code>中的<code>max_trx_id</code>值，表明生成该版本的事务在当前事务生成<code>ReadView</code>后才开启，所以该版本不可以被当前事务访问。</li> <li>如果被访问版本的<code>trx_id</code>属性值在<code>ReadView</code>的<code>min_trx_id</code>和<code>max_trx_id</code>之间，那就需要判断一下<code>trx_id</code>属性值是不是在<code>m_ids</code>列表中，如果在，说明创建<code>ReadView</code>时生成该版本的事务还是活跃的，该版本不可以被访问；如果不在，说明创建<code>ReadView</code>时生成该版本的事务已经被提交，该版本可以被访问。</li></ul> <p>如果某个版本的数据对当前事务不可见的话，那就顺着版本链找到下一个版本的数据，继续按照上边的步骤判断可见性，依此类推，直到版本链中的最后一个版本。如果最后一个版本也不可见的话，那么就意味着该条记录对该事务完全不可见，查询结果就不包含该记录。</p> <h3 id="数据存储介绍"><a href="#数据存储介绍" class="header-anchor">#</a> 数据存储介绍</h3> <p><img src="/mflyyou/assets/img/20200921183000.5c99b36c.png" alt="image-20200921113000653"></p> <h3 id="表空间"><a href="#表空间" class="header-anchor">#</a> 表空间</h3> <p>在 <code>InnoDB</code> 存储引擎下，表相关的所有数据（比如业务数据和索引数据）都储存在**表空间（tablespace）**中。每张表都有一个自己的文件（.ibd）去储存相关数据（开启独立表空间设置）。</p> <p>表空间又可以细分为 <code>segment</code>，<code>extent</code>，<code>page</code>，<code>row</code>。</p> <h3 id="段"><a href="#段" class="header-anchor">#</a> 段</h3> <p>表空间又包含多个段（segment），常见的数据段有：</p> <ul><li><code>Leaf node segment</code> 数据段，存储当前表中的数据</li> <li><code>Non-Leaf node segment</code> 索引段，存储当前表中的索引</li></ul> <h3 id="区"><a href="#区" class="header-anchor">#</a> 区</h3> <p>段包含很多个区，每个区始终为 1MB 。区由多个连续连续的页组成，页的大小通常是 16KB，所以一个区可以有 64 （1024/16=64）个连续页。</p> <h3 id="页"><a href="#页" class="header-anchor">#</a> 页</h3> <p><strong>页是 <code>InnoDB</code> 与磁盘交互的最小单位</strong>。从磁盘上读取数据，一次性是读取一页数据。将内存中的数据落盘到硬盘上，也是操作一页数据。</p> <p>比如我们修改了 <code>id=3</code> 某行数据，数据持久化的时候，是需要将这行所在的页全部落盘在硬盘上。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> test_table <span class="token keyword">set</span> a<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">where</span> id <span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre></div><p>页也有类型，数据页，索引页等等。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查看页的大小，默认是 16KB =16*1024bit</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%innodb_page_size%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------+-------+</span>
<span class="token operator">|</span> Variable_name    <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+-------+</span>
<span class="token operator">|</span> innodb_page_size <span class="token operator">|</span> <span class="token number">16384</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+-------+</span>
</code></pre></div><h3 id="行"><a href="#行" class="header-anchor">#</a> 行</h3> <p>每页存放一行一行的数据。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">&quot;test_data_type&quot;</span>\G<span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token number">1.</span> <span class="token keyword">row</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
           Name: test_data_type
         <span class="token keyword">Engine</span>: <span class="token keyword">InnoDB</span>
        Version: <span class="token number">10</span>
     Row_format: Dynamic
           <span class="token keyword">Rows</span>: <span class="token number">22</span>
 Avg_row_length: <span class="token number">14894</span>
    Data_length: <span class="token number">327680</span>
Max_data_length: <span class="token number">0</span>
   Index_length: <span class="token number">0</span>
      Data_free: <span class="token number">0</span>
 <span class="token keyword">Auto_increment</span>: <span class="token number">243</span>
    Create_time: <span class="token number">2020</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">01</span>:<span class="token number">55</span>:<span class="token number">51</span>
    Update_time: <span class="token number">2020</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">02</span>:<span class="token number">06</span>:<span class="token number">59</span>
     Check_time: <span class="token boolean">NULL</span>
      Collation: utf8mb4_0900_ai_ci
       Checksum: <span class="token boolean">NULL</span>
 Create_options:
        <span class="token keyword">Comment</span>:
</code></pre></div><p><code>Row_format</code> 定义了一行数据在数据页中怎么保存。</p> <p><img src="/mflyyou/assets/img/169710e973b70372~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.be467b46.png" alt="image_1c9h256f9nke14311adhtu61ie2dn.png-92kB"></p> <p>一个页一般是 <code>16KB</code>，当记录中的某个字段类型数据太大，当前页放不下的时候，会把多余的数据存储到其他页中，这种现象称为<code>行溢出</code>。</p> <p>然后会在当前行数据中保存行溢出数据所在的页。</p> <p>行数据中，除了我们表结构中自己定义的字段，还有 Mysql 添加的元数据字段。比如 <code>row_id</code>（当没有主键数据的时候添加），<code>transaction_id</code>（主要用于 MVCC）和 <code>roll_pointer</code> 。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhangpanqin/mflyyou/edit/main/docs/devops/database/mysql/mysql-arch.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/6/6 下午3:29:38</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
            ←
            <a href="/mflyyou/devops/database/mysql/" class="prev router-link-active">
                Mysql 基础
            </a></span> <span class="next"><a href="/mflyyou/devops/database/mysql/mysql-index.html">
                Mysql索引
            </a>
            →
        </span></p></div> </main> <aside class="right-sidebar"> <div class="right-sidebar-toc-container" style="display:;"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">Mysql 架构</div> <hr> <div class="toc-box"><ul><li><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mysql-架构说明" class="toc-sidebar-link">Mysql 架构说明</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mysql-工作流程" class="toc-sidebar-link">Mysql 工作流程</a></li></ul></li><li><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mysql-存储文件介绍" class="toc-sidebar-link">Mysql 存储文件介绍</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#查看-mysql-数据文件的目录" class="toc-sidebar-link">查看 Mysql 数据文件的目录</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#系统表空间" class="toc-sidebar-link">系统表空间</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#独立表空间" class="toc-sidebar-link">独立表空间</a></li></ul></li><li><a href="/mflyyou/devops/database/mysql/mysql-arch.html#innodb-存储引擎架构" class="toc-sidebar-link">InnoDB 存储引擎架构</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#buffer-pool" class="toc-sidebar-link">Buffer Pool</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#binlog" class="toc-sidebar-link">binlog</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#redo-log" class="toc-sidebar-link">redo log</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#两阶段提交" class="toc-sidebar-link">两阶段提交</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#分布式事务" class="toc-sidebar-link">分布式事务</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#undo-log" class="toc-sidebar-link">undo log</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#mvcc" class="toc-sidebar-link">MVCC</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#数据存储介绍" class="toc-sidebar-link">数据存储介绍</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#表空间" class="toc-sidebar-link">表空间</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#段" class="toc-sidebar-link">段</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#区" class="toc-sidebar-link">区</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#页" class="toc-sidebar-link">页</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/database/mysql/mysql-arch.html#行" class="toc-sidebar-link">行</a></li></ul></li></ul></div></div></div></div> <div class="right-sidebar-toolbar"><div class="option-box"><img src="/mflyyou/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span></div> <div class="option-box"><img src="/mflyyou/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <div title="Mysql 基础" class="option-box" style="padding-left:2px;text-align:center;"><a href="/mflyyou/devops/database/mysql/" class="router-link-active"><img src="/mflyyou/images/system/pre2.png" width="30px" class="nozoom"> <span class="show-txt">上一篇</span></a></div> <div title="Mysql索引" class="option-box" style="padding-left:2px;text-align:center;"><a href="/mflyyou/devops/database/mysql/mysql-index.html"><img src="/mflyyou/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div> </aside></div><div class="global-ui"><!----><!----></div></div>
    <script src="/mflyyou/assets/js/app.1ebce3ec.js" defer></script><script src="/mflyyou/assets/js/5.060b7482.js" defer></script><script src="/mflyyou/assets/js/2.337a644b.js" defer></script><script src="/mflyyou/assets/js/7.09832819.js" defer></script><script src="/mflyyou/assets/js/13.4af4aae9.js" defer></script>
  </body>
</html>
