<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mysql 数据类型 | Mflyyou</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/mflyyou/favicon.ico">
    <meta name="description" content="张攀钦的笔记">
    <meta name="theme-color" content="#3eaf7c">
    
    <link rel="preload" href="/mflyyou/assets/css/0.styles.b6588544.css" as="style"><link rel="preload" href="/mflyyou/assets/js/app.1ebce3ec.js" as="script"><link rel="preload" href="/mflyyou/assets/js/5.060b7482.js" as="script"><link rel="preload" href="/mflyyou/assets/js/2.337a644b.js" as="script"><link rel="preload" href="/mflyyou/assets/js/46.dc39c419.js" as="script"><link rel="preload" href="/mflyyou/assets/js/13.4af4aae9.js" as="script"><link rel="prefetch" href="/mflyyou/assets/js/10.13d2098d.js"><link rel="prefetch" href="/mflyyou/assets/js/100.6b5f6658.js"><link rel="prefetch" href="/mflyyou/assets/js/101.1309bb11.js"><link rel="prefetch" href="/mflyyou/assets/js/102.a670d5e1.js"><link rel="prefetch" href="/mflyyou/assets/js/103.a654de66.js"><link rel="prefetch" href="/mflyyou/assets/js/104.3ee8ac1b.js"><link rel="prefetch" href="/mflyyou/assets/js/105.f865a9da.js"><link rel="prefetch" href="/mflyyou/assets/js/106.3db4bc18.js"><link rel="prefetch" href="/mflyyou/assets/js/107.86df4273.js"><link rel="prefetch" href="/mflyyou/assets/js/108.b7e9e440.js"><link rel="prefetch" href="/mflyyou/assets/js/11.0bf0370f.js"><link rel="prefetch" href="/mflyyou/assets/js/12.fa71d27f.js"><link rel="prefetch" href="/mflyyou/assets/js/14.1489cead.js"><link rel="prefetch" href="/mflyyou/assets/js/15.2ee76f25.js"><link rel="prefetch" href="/mflyyou/assets/js/16.84f457ea.js"><link rel="prefetch" href="/mflyyou/assets/js/17.5d4f1dec.js"><link rel="prefetch" href="/mflyyou/assets/js/18.c6b9fecb.js"><link rel="prefetch" href="/mflyyou/assets/js/19.1035b370.js"><link rel="prefetch" href="/mflyyou/assets/js/20.def9a443.js"><link rel="prefetch" href="/mflyyou/assets/js/21.26682c03.js"><link rel="prefetch" href="/mflyyou/assets/js/22.62a9c6b0.js"><link rel="prefetch" href="/mflyyou/assets/js/23.515399df.js"><link rel="prefetch" href="/mflyyou/assets/js/24.6bf3a2cd.js"><link rel="prefetch" href="/mflyyou/assets/js/25.a7fc332e.js"><link rel="prefetch" href="/mflyyou/assets/js/26.acc05f74.js"><link rel="prefetch" href="/mflyyou/assets/js/27.df62034b.js"><link rel="prefetch" href="/mflyyou/assets/js/28.a17f9051.js"><link rel="prefetch" href="/mflyyou/assets/js/29.bf9b8bf2.js"><link rel="prefetch" href="/mflyyou/assets/js/3.172e0e5c.js"><link rel="prefetch" href="/mflyyou/assets/js/30.c1b15405.js"><link rel="prefetch" href="/mflyyou/assets/js/31.1ca60331.js"><link rel="prefetch" href="/mflyyou/assets/js/32.c60f993e.js"><link rel="prefetch" href="/mflyyou/assets/js/33.cd2ec5a7.js"><link rel="prefetch" href="/mflyyou/assets/js/34.2ae655a8.js"><link rel="prefetch" href="/mflyyou/assets/js/35.39f0314c.js"><link rel="prefetch" href="/mflyyou/assets/js/36.76ac8750.js"><link rel="prefetch" href="/mflyyou/assets/js/37.92fa0b22.js"><link rel="prefetch" href="/mflyyou/assets/js/38.1e81e861.js"><link rel="prefetch" href="/mflyyou/assets/js/39.e45c223b.js"><link rel="prefetch" href="/mflyyou/assets/js/4.17a133fa.js"><link rel="prefetch" href="/mflyyou/assets/js/40.850524c7.js"><link rel="prefetch" href="/mflyyou/assets/js/41.d904d47b.js"><link rel="prefetch" href="/mflyyou/assets/js/42.74644fc4.js"><link rel="prefetch" href="/mflyyou/assets/js/43.d9b5b83a.js"><link rel="prefetch" href="/mflyyou/assets/js/44.6c61b2f6.js"><link rel="prefetch" href="/mflyyou/assets/js/45.66700c63.js"><link rel="prefetch" href="/mflyyou/assets/js/47.0ddd4e71.js"><link rel="prefetch" href="/mflyyou/assets/js/48.053c6f31.js"><link rel="prefetch" href="/mflyyou/assets/js/49.6f5f4490.js"><link rel="prefetch" href="/mflyyou/assets/js/50.dd55f743.js"><link rel="prefetch" href="/mflyyou/assets/js/51.12a7ecf3.js"><link rel="prefetch" href="/mflyyou/assets/js/52.826138a9.js"><link rel="prefetch" href="/mflyyou/assets/js/53.9d5ff3e8.js"><link rel="prefetch" href="/mflyyou/assets/js/54.29061e3d.js"><link rel="prefetch" href="/mflyyou/assets/js/55.d814cfd2.js"><link rel="prefetch" href="/mflyyou/assets/js/56.c7059609.js"><link rel="prefetch" href="/mflyyou/assets/js/57.68dbe6db.js"><link rel="prefetch" href="/mflyyou/assets/js/58.06bbd4a4.js"><link rel="prefetch" href="/mflyyou/assets/js/59.3c39689b.js"><link rel="prefetch" href="/mflyyou/assets/js/6.939cdf3c.js"><link rel="prefetch" href="/mflyyou/assets/js/60.0c3fa548.js"><link rel="prefetch" href="/mflyyou/assets/js/61.34c71010.js"><link rel="prefetch" href="/mflyyou/assets/js/62.ccb9cf2e.js"><link rel="prefetch" href="/mflyyou/assets/js/63.ad9dc6aa.js"><link rel="prefetch" href="/mflyyou/assets/js/64.2ac503ea.js"><link rel="prefetch" href="/mflyyou/assets/js/65.d9e32710.js"><link rel="prefetch" href="/mflyyou/assets/js/66.9ad8e53d.js"><link rel="prefetch" href="/mflyyou/assets/js/67.d0e9b568.js"><link rel="prefetch" href="/mflyyou/assets/js/68.131208e9.js"><link rel="prefetch" href="/mflyyou/assets/js/69.152fc2aa.js"><link rel="prefetch" href="/mflyyou/assets/js/7.09832819.js"><link rel="prefetch" href="/mflyyou/assets/js/70.a6a4c0d9.js"><link rel="prefetch" href="/mflyyou/assets/js/71.35aa5807.js"><link rel="prefetch" href="/mflyyou/assets/js/72.1b63f1ed.js"><link rel="prefetch" href="/mflyyou/assets/js/73.d613ca64.js"><link rel="prefetch" href="/mflyyou/assets/js/74.b49eac90.js"><link rel="prefetch" href="/mflyyou/assets/js/75.cb165e12.js"><link rel="prefetch" href="/mflyyou/assets/js/76.0710e669.js"><link rel="prefetch" href="/mflyyou/assets/js/77.52c1a01a.js"><link rel="prefetch" href="/mflyyou/assets/js/78.c748b2b5.js"><link rel="prefetch" href="/mflyyou/assets/js/79.c2d56fac.js"><link rel="prefetch" href="/mflyyou/assets/js/8.0139ba8e.js"><link rel="prefetch" href="/mflyyou/assets/js/80.b4badf91.js"><link rel="prefetch" href="/mflyyou/assets/js/81.a2e99bcd.js"><link rel="prefetch" href="/mflyyou/assets/js/82.5c0e5ecc.js"><link rel="prefetch" href="/mflyyou/assets/js/83.290d422f.js"><link rel="prefetch" href="/mflyyou/assets/js/84.f26844dd.js"><link rel="prefetch" href="/mflyyou/assets/js/85.c226a65d.js"><link rel="prefetch" href="/mflyyou/assets/js/86.f9fd95fe.js"><link rel="prefetch" href="/mflyyou/assets/js/87.cdb9b919.js"><link rel="prefetch" href="/mflyyou/assets/js/88.5f3630e8.js"><link rel="prefetch" href="/mflyyou/assets/js/89.43523bf0.js"><link rel="prefetch" href="/mflyyou/assets/js/9.5bef5ca8.js"><link rel="prefetch" href="/mflyyou/assets/js/90.e2cb20cd.js"><link rel="prefetch" href="/mflyyou/assets/js/91.4f92828a.js"><link rel="prefetch" href="/mflyyou/assets/js/92.b42ed060.js"><link rel="prefetch" href="/mflyyou/assets/js/93.fa96fb9d.js"><link rel="prefetch" href="/mflyyou/assets/js/94.ef7b58a2.js"><link rel="prefetch" href="/mflyyou/assets/js/95.f452a910.js"><link rel="prefetch" href="/mflyyou/assets/js/96.36d19357.js"><link rel="prefetch" href="/mflyyou/assets/js/97.1e0d9cd1.js"><link rel="prefetch" href="/mflyyou/assets/js/98.c1326730.js"><link rel="prefetch" href="/mflyyou/assets/js/99.2401c0fe.js">
    <link rel="stylesheet" href="/mflyyou/assets/css/0.styles.b6588544.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mflyyou/" class="home-link router-link-active"><!----> <span class="site-name">Mflyyou</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mflyyou/java/base/java-messy-code.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/mflyyou/go/base/go-command.html" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mflyyou/springboot/project-sumary/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/mflyyou/tcp-ip/http/http-cors-jsonp/" class="nav-link">
  TCP/IP
</a></div><div class="nav-item"><a href="/mflyyou/dev-tools/asdf/" class="nav-link">
  开发工具
</a></div><div class="nav-item"><a href="/mflyyou/devops/docker/" class="nav-link">
  DevOps
</a></div> <a href="https://github.com/zhangpanqin/mflyyou" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mflyyou/java/base/java-messy-code.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/mflyyou/go/base/go-command.html" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mflyyou/springboot/project-sumary/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/mflyyou/tcp-ip/http/http-cors-jsonp/" class="nav-link">
  TCP/IP
</a></div><div class="nav-item"><a href="/mflyyou/dev-tools/asdf/" class="nav-link">
  开发工具
</a></div><div class="nav-item"><a href="/mflyyou/devops/docker/" class="nav-link">
  DevOps
</a></div> <a href="https://github.com/zhangpanqin/mflyyou" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/docker/" class="sidebar-link">Docker</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Terraform</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/terraform/" class="sidebar-link">Terraform</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>AWS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/aws/" class="sidebar-link">Aws</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/linux/linux-base.html" class="sidebar-link">Linux 基础</a></li><li><a href="/mflyyou/devops/linux/vim.html" class="sidebar-link">Vim</a></li><li><a href="/mflyyou/devops/linux/ssh.html" class="sidebar-link">SSH</a></li><li><a href="/mflyyou/devops/linux/redirect-pipeline.html" class="sidebar-link">重定向和管道流</a></li><li><a href="/mflyyou/devops/linux/debian.html" class="sidebar-link">Debian</a></li><li><a href="/mflyyou/devops/linux/shell-base.html" class="sidebar-link">shell 基础</a></li><li><a href="/mflyyou/devops/linux/shell-example.html" class="sidebar-link">实用的 shell 列子</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>auth0</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/auth0/auth0.html" class="sidebar-link">auth0</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/nginx/nginx-base.html" class="sidebar-link">Nginx-包教包会-入门</a></li><li><a href="/mflyyou/devops/nginx/nginx-config.html" class="sidebar-link">Nginx-性能优化</a></li><li><a href="/mflyyou/devops/nginx/nginx-performance.html" class="sidebar-link">Nginx-包教包会-进阶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/database/mysql/" aria-current="page" class="sidebar-link">Mysql 基础</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-arch.html" class="sidebar-link">Mysql 架构</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-index.html" class="sidebar-link">Mysql索引</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-lock-and-transaction.html" class="sidebar-link">Mysql 事务和锁</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-explain.html" class="sidebar-link">Explain 查看执行计划</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-limit.html" class="sidebar-link">Mysql Limit 限制</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-data-types.html" aria-current="page" class="active sidebar-link">Mysql 数据类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/mflyyou/devops/database/mysql/mysql-account-management.html" class="sidebar-link">Mysql 用户权限管理</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-backup-recovery.html" class="sidebar-link">Mysql数据备份与恢复</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>PostgreSql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/database/postgresql/postgresql.html" class="sidebar-link">PostgreSQL 基础</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Elasticsearch</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/elasticsearch/es.html" class="sidebar-link">Elasticsearch</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/redis/redis.html" class="sidebar-link">Redis 基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/vue/vue-depoly.html" class="sidebar-link">你不知道的 SpringBoot 与 Vue 部署解决方案</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mysql-数据类型"><a href="#mysql-数据类型" class="header-anchor">#</a> Mysql 数据类型</h1> <p><font color="red"><strong>表设计的时候一定要选取合适的数据类型，能用数字就不要用字符串，一是减少存储时空间的浪费，二是减少查询时内存的浪费。</strong></font></p> <h3 id="整型"><a href="#整型" class="header-anchor">#</a> 整型</h3> <table><thead><tr><th>类型</th> <th>描述</th> <th>占用字节</th> <th>范围</th></tr></thead> <tbody><tr><td>tinyint</td> <td>对应 java 中 byte</td> <td>1 字节</td> <td>有符号-128 至 127。<br>无符号 0 至 255</td></tr> <tr><td>smallint</td> <td>对应 java 中 short</td> <td>2 字节</td> <td>有符号 -32768 至 32767。<br>无符号 0 至 65535</td></tr> <tr><td>int</td> <td>对应 java 中 int</td> <td>4 字节</td> <td>有符号 -2147483648 至 2147483647。<br>无符号 0 至 4294967295</td></tr> <tr><td>bigint</td> <td>对应 java 中 long</td> <td>8 字节</td> <td>有符号 -9223372036854775808 至 9223372036854775807 <br>无符号 0 至 18446744073709551615</td></tr></tbody></table> <h3 id="小数"><a href="#小数" class="header-anchor">#</a> 小数</h3> <table><thead><tr><th>类型</th> <th>描述</th> <th>占用字节</th></tr></thead> <tbody><tr><td>FLOAT(M, D)</td> <td>对应 java 中 float</td> <td>4 字节</td></tr> <tr><td>DOUBLE(M, D)</td> <td>对应 java 中 double</td> <td>8 字节</td></tr> <tr><td>DECIMAL(M, D)</td> <td>对应 java 中 BigDecimal。定点数，可以精确保存小数</td> <td>M 和 D 决定</td></tr></tbody></table> <p><code>M</code> 表示小数的有效数字，<code>D</code> 表示小数点后的有效数字。</p> <p>FLOAT(4, 1) 不能存 4000.1 会报错误。</p> <h3 id="日期和时间"><a href="#日期和时间" class="header-anchor">#</a> 日期和时间</h3> <table><thead><tr><th>类型</th> <th>描述</th> <th>占用字节</th> <th>取值范围</th></tr></thead> <tbody><tr><td>YEAR</td> <td>年份</td> <td>1 字节</td> <td>1901~2155</td></tr> <tr><td>DATE</td> <td>日期，年月日</td> <td>3 字节</td> <td>1000-01-01~ 9999-12-31</td></tr> <tr><td>TIME(fsp)</td> <td>时间，时分秒</td> <td>3 字节</td> <td>-838:59:59.000000 ~ 838:59:59.000000</td></tr> <tr><td>DATETIME(fsp)</td> <td>日期+时间</td> <td>5 字节</td> <td>1000-01-01 00:00:00.000000 ~ 9999-12-31 23:59:59.999999</td></tr> <tr><td>TIMESTAMP(fsp)</td> <td>底层存储的是 UTC 时间戳，<br>显示值会随 mysql 数据库所在时区变化</td> <td>4 字节</td> <td>1970-01-01 00:00:01.000000 ~ 2038-01-19 03:14:07.999999</td></tr></tbody></table> <p><code>TIMESTAMP(fsp)</code> 中的 <strong>fsp</strong> 是指秒的精度(x.xxx xxx)，<strong>fsp</strong>取值 0，1，2，3，4，5，6。</p> <p><code>TIME</code>、<code>DATETIME</code>、<code>TIMESTAMP</code> 这几种类型支持小数秒。</p> <p><code>DATETIME(0)</code> 精确到秒，没有小数位。</p> <p><code>DATETIME(3)</code> 精确到豪秒，有三位小数。</p> <p><font color="red">**日期和时间存储时区的设置有关，一定要搞清楚原理。 **</font></p> <p><strong>TIMESTAMP</strong> 的显示和数据库系统设置的时区有关。<strong>TIMESTAMP</strong> 底层实际存储的是毫秒值，显示的时间是根据设置的时区（<strong>time_zone</strong>）转换为时间显示的。</p> <p>还有 Java 1.8 新增的 <code>LocalDateTime</code> 需要怎么转换 <code>Mysql</code> 中的时间呢。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查看 mysql 的时区设置</span>
<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">&quot;%time_zone%&quot;</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-txt extra-class"><pre class="language-txt"><code>mysql&gt; SHOW VARIABLES LIKE &quot;%time_zone%&quot;;
+------------------+--------+
| Variable_name    | Value  |
+------------------+--------+
| system_time_zone | CET    |
| time_zone        | +08:00 |
+------------------+--------+
</code></pre></div><p><code>system_time_zone</code> 是 <code>Mysql</code> 启动的时候获取计算机系统所在的时区。只要计算机的时间准确就没有问题。</p> <p><code>time_zone</code> 设置的是连接 mysql 的会话中，时间 （java.util.Date）转换为字符串时的 TimeZone。<code>time_zone</code> 这个值可以被 jdbc 连接中的 <code>serverTimezone=Asia/Shanghai</code> 覆盖。</p> <p>因为我们是在东八区，希望时间都转换为东八区时间。</p> <div class="language-mysql extra-class"><pre class="language-text"><code>[mysqld]
# 将时间转换为东八区的时间
default-time-zone = '+08:00'
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>test_data_type<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>test_data_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>test_timestamp<span class="token punctuation">`</span></span> <span class="token keyword">timestamp</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">243</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_0900_ai_ci

<span class="token comment">-- 实际保存数据的时候需要将日期转换为字符串，拼接成这样的 sql</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_data_type <span class="token punctuation">(</span>test_data_time<span class="token punctuation">,</span>test_timestamp<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'2020-12-12 12:12:12'</span><span class="token punctuation">,</span><span class="token string">'2020-12-12 12:12:12'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>比如我们将 java 中的 <code>LocalDateTime</code> 存为 datetime 类型。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;test_data_type&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDataType</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;test_data_time&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> testDataTime<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;test_timestamp&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> testTimestamp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当我们保存数据的时候，需要根据配置的 time_zone,将 LocalDateTime 转为 String，在替换到 sql 中的 <code>?</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_data_type <span class="token punctuation">(</span>test_data_time<span class="token punctuation">,</span>test_timestamp<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>?<span class="token punctuation">,</span>?<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">// NativeProtocol.configureTimezone 可以看到这个逻辑</span>
<span class="token variable">@Test</span>
<span class="token keyword">public</span> void run33<span class="token punctuation">(</span><span class="token punctuation">)</span> {
	<span class="token comment">// 首先获取到在服务器设置的 time_zone，如果没有设置的话，默认取 mysql 服务器所在时区</span>
	String configuredTimeZoneOnServer <span class="token operator">=</span> this<span class="token punctuation">.</span>serverSession<span class="token punctuation">.</span>getServerVariable<span class="token punctuation">(</span><span class="token string">&quot;time_zone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// jdbc 链接中设置的参数</span>
	String canonicalTimezone <span class="token operator">=</span> getStringProperty<span class="token punctuation">(</span><span class="token string">&quot;serverTimezone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>canonicalTimezone<span class="token operator">=</span><span class="token operator">=</span><span class="token boolean">null</span><span class="token operator">||</span>canonicalTimezone<span class="token punctuation">.</span>length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>{
		canonicalTimezone<span class="token operator">=</span>configuredTimeZoneOnServer<span class="token punctuation">;</span>
	}
	<span class="token comment">// jdbc url 参数中配置的 serverTimezone 和 time_zone 都是为了获取 TimeZone，serverTimezone 的优先级更高</span>
 	final TimeZone timeZone <span class="token operator">=</span> TimeZone<span class="token punctuation">.</span>getTimeZone<span class="token punctuation">(</span>canonicalTimezone<span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token comment">// Timestamp 继承了 java.util.Date</span>
 	<span class="token comment">// 这里会将获得 LocalDateTime 获取其年月日时分秒上的值</span>
    final <span class="token keyword">Timestamp</span> <span class="token keyword">timestamp</span> <span class="token operator">=</span> <span class="token keyword">Timestamp</span><span class="token punctuation">.</span>valueOf<span class="token punctuation">(</span>LocalDateTime<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    final SimpleDateFormat simpleDateFormat <span class="token operator">=</span> new SimpleDateFormat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    simpleDateFormat<span class="token punctuation">.</span>applyPattern<span class="token punctuation">(</span><span class="token string">&quot;yyyy.MM.dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    simpleDateFormat<span class="token punctuation">.</span>setTimeZone<span class="token punctuation">(</span>timeZone<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 然后将这个 time 替换 ？</span>
   	String <span class="token keyword">time</span><span class="token operator">=</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">timestamp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre></div><h4 id="时区设置结论"><a href="#时区设置结论" class="header-anchor">#</a> 时区设置结论</h4> <p><font color="red"><strong>当我们保存数据的创建时间的时候，只需获取当前时间就行。当前时区与东八区的时差，mysql 配置的 <code>time_zone</code>和 <code>serverTimezone</code> 转换成字符串时会自动加上。</strong></font></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">Date</span> createTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// LocalDateTime 一定不要自己补时差，不然时间会对不上</span>
<span class="token keyword">final</span> <span class="token class-name">LocalDateTime</span> createTime2 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 下面这个用法是错误的。这样数据库中保存的时间比实际时间多了八个小时</span>
<span class="token keyword">final</span> <span class="token class-name">LocalDateTime</span> errorCreateTime <span class="token operator">=</span>  <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;UTC+8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h3> <h4 id="varchar"><a href="#varchar" class="header-anchor">#</a> varchar</h4> <p>varchar (M) 中 M 指的是字符数。<font color="red"><strong>Mysql 限制在一行数据中，所有 varchar 列的总字节数不能超过 65535 字节。</strong></font></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- utf8mb4 实际会占用 1-3 字节</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>test_varchar<span class="token punctuation">`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>test_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4  <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8mb4<span class="token punctuation">;</span>
</code></pre></div><p>执行上述 sql 报错为：</p> <div class="language-txt extra-class"><pre class="language-txt"><code>1074 - Column length too big for column 'test_name' (max = 16383); use BLOB or TEXT instead, Time: 0.000000s
</code></pre></div><p>验证所有 varchar 列总数据不能超过 65535</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>test_varchar<span class="token punctuation">`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>test_name1<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">7000</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token identifier"><span class="token punctuation">`</span>test_name2<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">7000</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token identifier"><span class="token punctuation">`</span>test_name3<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">7000</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4  <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8mb4<span class="token punctuation">;</span>
</code></pre></div><p>执行上述 sql 报错信息为</p> <div class="language-txt extra-class"><pre class="language-txt"><code>1118 - Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs, Time: 0.002000s
</code></pre></div><p>varchar (M) 实际占用字节数，除了数据的占用，还有数据字节数大小的记录（1-2 字节）。</p> <p><font color="red"><strong>varchar(255) 存储的 abc 的时候占用 4 个字节，但是这个数据加载到内存的时候是占用定义的时候指定的字节数 （255*3 utf8 编码）所以这个数值不要随便填写</strong></font></p> <h4 id="char"><a href="#char" class="header-anchor">#</a> char</h4> <p>char(M) M 也是指的字符数，列采用的字符集不同，char 类型数据占用大小也不一样。char 类型的数据没有达到指定字符数，数据库会自动补充空格，返回数据的时候在去掉空格。</p> <p>当一个字符串太长的时候一定要采取 text 类型的数据，text 类型的数据存储的时候会作为行溢出数据存储，就没有 65535 大小的限制。</p> <div class="language-txt extra-class"><pre class="language-txt"><code>// 可以看到占用
https://dev.mysql.com/doc/refman/8.0/en/storage-requirements.html
</code></pre></div><table><thead><tr><th>数据类型</th> <th>总字节数</th> <th>内容字节</th></tr></thead> <tbody><tr><td>VARCHAR(M)、VARBINARY(M)</td> <td>L+ 1 bytes if column values require 0 − 255 bytes,<br>L+ 2 bytes if values may require more than 255 bytes</td> <td></td></tr> <tr><td>TINYBLOB 、TINYTEXT</td> <td>L+1</td> <td>L&lt;2^8</td></tr> <tr><td>BLOB、TEXT</td> <td>L + 2</td> <td>L&lt;2^16</td></tr> <tr><td>MEDIUMBLOB、MEDIUMTEXT</td> <td>L+ 3</td> <td>L&lt;2^24</td></tr> <tr><td>LONGBLOB、LONGTEXT</td> <td>L+ 4</td> <td>L&lt;2^32</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhangpanqin/mflyyou/edit/main/docs/devops/database/mysql/mysql-data-types.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/6/6 下午3:29:38</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
            ←
            <a href="/mflyyou/devops/database/mysql/mysql-limit.html" class="prev">
                Mysql Limit 限制
            </a></span> <span class="next"><a href="/mflyyou/devops/database/mysql/mysql-account-management.html">
                Mysql 用户权限管理
            </a>
            →
        </span></p></div> </main> <aside class="right-sidebar"> <div class="right-sidebar-toc-container" style="display:;"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">Mysql 数据类型</div> <hr> <div class="toc-box"><!----></div></div></div></div> <div class="right-sidebar-toolbar"><div class="option-box"><img src="/mflyyou/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span></div> <div class="option-box"><img src="/mflyyou/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <div title="Mysql Limit 限制" class="option-box" style="padding-left:2px;text-align:center;"><a href="/mflyyou/devops/database/mysql/mysql-limit.html"><img src="/mflyyou/images/system/pre2.png" width="30px" class="nozoom"> <span class="show-txt">上一篇</span></a></div> <div title="Mysql 用户权限管理" class="option-box" style="padding-left:2px;text-align:center;"><a href="/mflyyou/devops/database/mysql/mysql-account-management.html"><img src="/mflyyou/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div> </aside></div><div class="global-ui"><!----><!----></div></div>
    <script src="/mflyyou/assets/js/app.1ebce3ec.js" defer></script><script src="/mflyyou/assets/js/5.060b7482.js" defer></script><script src="/mflyyou/assets/js/2.337a644b.js" defer></script><script src="/mflyyou/assets/js/46.dc39c419.js" defer></script><script src="/mflyyou/assets/js/13.4af4aae9.js" defer></script>
  </body>
</html>
