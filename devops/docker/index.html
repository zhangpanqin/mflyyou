<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | Mflyyou</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/mflyyou/favicon.ico">
    <meta name="description" content="张攀钦的笔记">
    <meta name="theme-color" content="#3eaf7c">
    
    <link rel="preload" href="/mflyyou/assets/css/0.styles.69128c36.css" as="style"><link rel="preload" href="/mflyyou/assets/js/app.a8bf9193.js" as="script"><link rel="preload" href="/mflyyou/assets/js/4.527dd67c.js" as="script"><link rel="preload" href="/mflyyou/assets/js/2.40ff7517.js" as="script"><link rel="preload" href="/mflyyou/assets/js/51.89b2012e.js" as="script"><link rel="preload" href="/mflyyou/assets/js/13.5f8596a1.js" as="script"><link rel="prefetch" href="/mflyyou/assets/js/10.fe610f2b.js"><link rel="prefetch" href="/mflyyou/assets/js/100.2a8f2e91.js"><link rel="prefetch" href="/mflyyou/assets/js/101.ab22813f.js"><link rel="prefetch" href="/mflyyou/assets/js/102.25daf47a.js"><link rel="prefetch" href="/mflyyou/assets/js/103.2a87ff24.js"><link rel="prefetch" href="/mflyyou/assets/js/104.3d0e05c7.js"><link rel="prefetch" href="/mflyyou/assets/js/105.0b08c279.js"><link rel="prefetch" href="/mflyyou/assets/js/106.fbaeedbc.js"><link rel="prefetch" href="/mflyyou/assets/js/107.fd860e32.js"><link rel="prefetch" href="/mflyyou/assets/js/108.06d8d7ec.js"><link rel="prefetch" href="/mflyyou/assets/js/109.82b370ae.js"><link rel="prefetch" href="/mflyyou/assets/js/11.e14bd538.js"><link rel="prefetch" href="/mflyyou/assets/js/110.fe54b70a.js"><link rel="prefetch" href="/mflyyou/assets/js/111.712c964e.js"><link rel="prefetch" href="/mflyyou/assets/js/12.7ba814ee.js"><link rel="prefetch" href="/mflyyou/assets/js/14.79a24b30.js"><link rel="prefetch" href="/mflyyou/assets/js/15.4831c6e8.js"><link rel="prefetch" href="/mflyyou/assets/js/16.15dd012d.js"><link rel="prefetch" href="/mflyyou/assets/js/17.af48cb1a.js"><link rel="prefetch" href="/mflyyou/assets/js/18.e114ea09.js"><link rel="prefetch" href="/mflyyou/assets/js/19.6dfbb6a2.js"><link rel="prefetch" href="/mflyyou/assets/js/20.b16006a0.js"><link rel="prefetch" href="/mflyyou/assets/js/21.5993bbcc.js"><link rel="prefetch" href="/mflyyou/assets/js/22.fd78f81f.js"><link rel="prefetch" href="/mflyyou/assets/js/23.61ff4b4a.js"><link rel="prefetch" href="/mflyyou/assets/js/24.12dd4a8f.js"><link rel="prefetch" href="/mflyyou/assets/js/25.bcf528a1.js"><link rel="prefetch" href="/mflyyou/assets/js/26.e3cadf96.js"><link rel="prefetch" href="/mflyyou/assets/js/27.82c6a4bb.js"><link rel="prefetch" href="/mflyyou/assets/js/28.a749a29d.js"><link rel="prefetch" href="/mflyyou/assets/js/29.3afd32f8.js"><link rel="prefetch" href="/mflyyou/assets/js/3.88c3d473.js"><link rel="prefetch" href="/mflyyou/assets/js/30.47874b53.js"><link rel="prefetch" href="/mflyyou/assets/js/31.2bac6e3e.js"><link rel="prefetch" href="/mflyyou/assets/js/32.8ba7ef39.js"><link rel="prefetch" href="/mflyyou/assets/js/33.1aac2d68.js"><link rel="prefetch" href="/mflyyou/assets/js/34.40132ce2.js"><link rel="prefetch" href="/mflyyou/assets/js/35.606c7fd4.js"><link rel="prefetch" href="/mflyyou/assets/js/36.bb9c1ae7.js"><link rel="prefetch" href="/mflyyou/assets/js/37.5fea3731.js"><link rel="prefetch" href="/mflyyou/assets/js/38.4f34dca0.js"><link rel="prefetch" href="/mflyyou/assets/js/39.fe4d8235.js"><link rel="prefetch" href="/mflyyou/assets/js/40.d11c705d.js"><link rel="prefetch" href="/mflyyou/assets/js/41.ecda4f10.js"><link rel="prefetch" href="/mflyyou/assets/js/42.9572a923.js"><link rel="prefetch" href="/mflyyou/assets/js/43.7cc4c727.js"><link rel="prefetch" href="/mflyyou/assets/js/44.11f3ceab.js"><link rel="prefetch" href="/mflyyou/assets/js/45.46a220e7.js"><link rel="prefetch" href="/mflyyou/assets/js/46.63b9ccf0.js"><link rel="prefetch" href="/mflyyou/assets/js/47.de93721c.js"><link rel="prefetch" href="/mflyyou/assets/js/48.7536d656.js"><link rel="prefetch" href="/mflyyou/assets/js/49.7d0cb3be.js"><link rel="prefetch" href="/mflyyou/assets/js/5.a3558958.js"><link rel="prefetch" href="/mflyyou/assets/js/50.f18efcab.js"><link rel="prefetch" href="/mflyyou/assets/js/52.ac0d172a.js"><link rel="prefetch" href="/mflyyou/assets/js/53.0bf43b16.js"><link rel="prefetch" href="/mflyyou/assets/js/54.5ec28964.js"><link rel="prefetch" href="/mflyyou/assets/js/55.042fc13c.js"><link rel="prefetch" href="/mflyyou/assets/js/56.90f6125a.js"><link rel="prefetch" href="/mflyyou/assets/js/57.214a9dbd.js"><link rel="prefetch" href="/mflyyou/assets/js/58.c2817095.js"><link rel="prefetch" href="/mflyyou/assets/js/59.12e56810.js"><link rel="prefetch" href="/mflyyou/assets/js/6.022ec18f.js"><link rel="prefetch" href="/mflyyou/assets/js/60.dae65c33.js"><link rel="prefetch" href="/mflyyou/assets/js/61.a03c4cd4.js"><link rel="prefetch" href="/mflyyou/assets/js/62.6a3fb5f0.js"><link rel="prefetch" href="/mflyyou/assets/js/63.cd496ede.js"><link rel="prefetch" href="/mflyyou/assets/js/64.969198b0.js"><link rel="prefetch" href="/mflyyou/assets/js/65.b49070f3.js"><link rel="prefetch" href="/mflyyou/assets/js/66.b0884b29.js"><link rel="prefetch" href="/mflyyou/assets/js/67.4429a9c0.js"><link rel="prefetch" href="/mflyyou/assets/js/68.ab448e96.js"><link rel="prefetch" href="/mflyyou/assets/js/69.fe9f6ad2.js"><link rel="prefetch" href="/mflyyou/assets/js/7.b3070f80.js"><link rel="prefetch" href="/mflyyou/assets/js/70.7bc80c52.js"><link rel="prefetch" href="/mflyyou/assets/js/71.ca7b589d.js"><link rel="prefetch" href="/mflyyou/assets/js/72.2e14eb54.js"><link rel="prefetch" href="/mflyyou/assets/js/73.af8969be.js"><link rel="prefetch" href="/mflyyou/assets/js/74.0feb0f31.js"><link rel="prefetch" href="/mflyyou/assets/js/75.eac9e2b1.js"><link rel="prefetch" href="/mflyyou/assets/js/76.09cb807b.js"><link rel="prefetch" href="/mflyyou/assets/js/77.3b220ee5.js"><link rel="prefetch" href="/mflyyou/assets/js/78.3e829a87.js"><link rel="prefetch" href="/mflyyou/assets/js/79.969a3ebc.js"><link rel="prefetch" href="/mflyyou/assets/js/8.0476bdcb.js"><link rel="prefetch" href="/mflyyou/assets/js/80.3b1eaa71.js"><link rel="prefetch" href="/mflyyou/assets/js/81.cee862bc.js"><link rel="prefetch" href="/mflyyou/assets/js/82.ac0c77ea.js"><link rel="prefetch" href="/mflyyou/assets/js/83.8556145a.js"><link rel="prefetch" href="/mflyyou/assets/js/84.bbaf5bc2.js"><link rel="prefetch" href="/mflyyou/assets/js/85.a2f77426.js"><link rel="prefetch" href="/mflyyou/assets/js/86.21b31e38.js"><link rel="prefetch" href="/mflyyou/assets/js/87.fa3b9bc7.js"><link rel="prefetch" href="/mflyyou/assets/js/88.e33a8115.js"><link rel="prefetch" href="/mflyyou/assets/js/89.599b9ed1.js"><link rel="prefetch" href="/mflyyou/assets/js/9.c7c2531e.js"><link rel="prefetch" href="/mflyyou/assets/js/90.5c28eb58.js"><link rel="prefetch" href="/mflyyou/assets/js/91.724ab59f.js"><link rel="prefetch" href="/mflyyou/assets/js/92.81e31fb8.js"><link rel="prefetch" href="/mflyyou/assets/js/93.79768caa.js"><link rel="prefetch" href="/mflyyou/assets/js/94.60d0a3cf.js"><link rel="prefetch" href="/mflyyou/assets/js/95.fdd06ba3.js"><link rel="prefetch" href="/mflyyou/assets/js/96.f8f11ed9.js"><link rel="prefetch" href="/mflyyou/assets/js/97.c427f1d5.js"><link rel="prefetch" href="/mflyyou/assets/js/98.4cc70c16.js"><link rel="prefetch" href="/mflyyou/assets/js/99.48464bb8.js">
    <link rel="stylesheet" href="/mflyyou/assets/css/0.styles.69128c36.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mflyyou/" class="home-link router-link-active"><!----> <span class="site-name">Mflyyou</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mflyyou/java/base/java-messy-code.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/mflyyou/go/base/go-command.html" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mflyyou/springboot/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/mflyyou/tcp-ip/http/http-cors-jsonp/" class="nav-link">
  TCP/IP
</a></div><div class="nav-item"><a href="/mflyyou/dev-tools/asdf/" class="nav-link">
  开发工具
</a></div><div class="nav-item"><a href="/mflyyou/devops/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  DevOps
</a></div> <a href="https://github.com/zhangpanqin/mflyyou" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mflyyou/java/base/java-messy-code.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/mflyyou/go/base/go-command.html" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mflyyou/springboot/" class="nav-link">
  SpringBoot
</a></div><div class="nav-item"><a href="/mflyyou/tcp-ip/http/http-cors-jsonp/" class="nav-link">
  TCP/IP
</a></div><div class="nav-item"><a href="/mflyyou/dev-tools/asdf/" class="nav-link">
  开发工具
</a></div><div class="nav-item"><a href="/mflyyou/devops/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  DevOps
</a></div> <a href="https://github.com/zhangpanqin/mflyyou" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/docker/" aria-current="page" class="active sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#colima" class="sidebar-link">colima</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#docker-command" class="sidebar-link">docker command</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#镜像介绍" class="sidebar-link">镜像介绍</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#多阶段构建" class="sidebar-link">多阶段构建</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#基础镜像选择" class="sidebar-link">基础镜像选择</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#google-distroless-image" class="sidebar-link">Google distroless image</a></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#该不该选择-alpine-做为基础镜像" class="sidebar-link">该不该选择 alpine 做为基础镜像？</a></li></ul></li><li class="sidebar-sub-header"><a href="/mflyyou/devops/docker/#entrypoint-和-cmd" class="sidebar-link">ENTRYPOINT 和 CMD</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Terraform</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/terraform/" class="sidebar-link">Terraform</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>AWS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/aws/" class="sidebar-link">Aws</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/linux/linux-base.html" class="sidebar-link">Linux 基础</a></li><li><a href="/mflyyou/devops/linux/vim.html" class="sidebar-link">Vim</a></li><li><a href="/mflyyou/devops/linux/ssh.html" class="sidebar-link">SSH</a></li><li><a href="/mflyyou/devops/linux/redirect-pipeline.html" class="sidebar-link">重定向和管道流</a></li><li><a href="/mflyyou/devops/linux/debian.html" class="sidebar-link">Debian</a></li><li><a href="/mflyyou/devops/linux/shell-base.html" class="sidebar-link">shell 基础</a></li><li><a href="/mflyyou/devops/linux/shell-example.html" class="sidebar-link">实用的 shell 列子</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>auth0</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/auth0/auth0.html" class="sidebar-link">auth0</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/nginx/nginx-base.html" class="sidebar-link">Nginx-包教包会-入门</a></li><li><a href="/mflyyou/devops/nginx/nginx-config.html" class="sidebar-link">Nginx-性能优化</a></li><li><a href="/mflyyou/devops/nginx/nginx-performance.html" class="sidebar-link">Nginx-包教包会-进阶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/database/mysql/" class="sidebar-link">Mysql 基础</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-arch.html" class="sidebar-link">Mysql 架构</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-index.html" class="sidebar-link">Mysql索引</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-lock-and-transaction.html" class="sidebar-link">Mysql 事务和锁</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-explain.html" class="sidebar-link">Explain 查看执行计划</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-limit.html" class="sidebar-link">Mysql Limit 限制</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-data-types.html" class="sidebar-link">Mysql 数据类型</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-account-management.html" class="sidebar-link">Mysql 用户权限管理</a></li><li><a href="/mflyyou/devops/database/mysql/mysql-backup-recovery.html" class="sidebar-link">Mysql数据备份与恢复</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>PostgreSql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/database/postgresql/postgresql.html" class="sidebar-link">PostgreSQL 基础</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Elasticsearch</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/elasticsearch/es.html" class="sidebar-link">Elasticsearch</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/redis/redis.html" class="sidebar-link">Redis 基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mflyyou/devops/vue/vue-depoly.html" class="sidebar-link">你不知道的 SpringBoot 与 Vue 部署解决方案</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <p>由于 <a href="https://www.docker.com/products/docker-desktop/" target="_blank" rel="noopener noreferrer">Docker Desktop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 商业使用收费了，因此不能只将安装这个了。</p> <p>为了简便构建开发环境，还是需要 docker 的，所以用 <a href="https://github.com/abiosoft/colima" target="_blank" rel="noopener noreferrer">colima<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 代替。</p> <p>我们所说的 docker 实际上包含 command line interface client（docker），docker server（dockerd），docker compose 等相关组件。</p> <p>写 dockerfile 还是简单一些的，遇到复杂得再研究即可。</p> <p><a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener noreferrer">Dockerfile reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="colima"><a href="#colima" class="header-anchor">#</a> colima</h2> <p>可以在本地运行 docker 命令。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>colima start
colima stop
</code></pre></div><h2 id="docker-command"><a href="#docker-command" class="header-anchor">#</a> docker command</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 构建 image</span>
<span class="token function">docker</span> build <span class="token builtin class-name">.</span> <span class="token parameter variable">-t</span> vue-demo:0.0.1
<span class="token comment"># 有的时候想看看 image 有什么文件。4bd0f9394726 是 image 的 id</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--entrypoint</span> <span class="token function">sh</span> 4bd0f9394726
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--entrypoint</span> <span class="token function">sh</span> vue-demo:0.0.1
<span class="token comment"># 查看 image 信息</span>
<span class="token function">docker</span> inspect 4bd0f9394726
</code></pre></div><h2 id="镜像介绍"><a href="#镜像介绍" class="header-anchor">#</a> 镜像介绍</h2> <p>随波逐流选镜像，我看好多官方镜像都是以 <code>debian:bullseye-slim</code> 作为基础镜像。</p> <p><code>bullseye</code> 是 debian 11 的代号。slim 是最小镜像。</p> <h2 id="多阶段构建"><a href="#多阶段构建" class="header-anchor">#</a> 多阶段构建</h2> <div class="language- extra-class"><pre class="language-text"><code># Start by building the application.
FROM golang:1.18 as build

WORKDIR /go/src/app
COPY . .

RUN go mod download
RUN CGO_ENABLED=0 go build -o /go/bin/app

# Now copy it into our base image.
FROM gcr.io/distroless/static-debian11
COPY --from=build /go/bin/app /
CMD [&quot;/app&quot;]
</code></pre></div><p>第一阶段构建，第二阶段只是打包最终运行的程序。比如 java 构建的时候需要 gradle 什么的，我只把 jar 包最终放到 docker image 中。</p> <h2 id="基础镜像选择"><a href="#基础镜像选择" class="header-anchor">#</a> 基础镜像选择</h2> <h3 id="google-distroless-image"><a href="#google-distroless-image" class="header-anchor">#</a> Google distroless image</h3> <p><a href="https://github.com/GoogleContainerTools/distroless" target="_blank" rel="noopener noreferrer">google distroless github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://console.cloud.google.com/gcr/images/distroless/GLOBAL" target="_blank" rel="noopener noreferrer">google distroless Container Registry <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>java ，node，go，python 等等都提供了镜像支持。而且考虑安全和最小体积。</p> <p>比如说 java17-debian11 它只能够运行 java 程序，而没有包含 shell 环境和软件包管理。</p> <p>第一优先级我会选择 google 的镜像。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Distroless images contain only your application and its runtime dependencies.</p> <p>They do not contain package managers, shells or any other programs you would expect to find in a standard Linux distribution.</p></div> <h3 id="该不该选择-alpine-做为基础镜像"><a href="#该不该选择-alpine-做为基础镜像" class="header-anchor">#</a> 该不该选择 alpine 做为基础镜像？</h3> <p>我们选择 alpine 的原因是它更小。</p> <p>alpine 它本来是用于嵌入式系统中的，应用于服务领域可能不太好。</p> <p><a href="https://alpinelinux.org/" target="_blank" rel="noopener noreferrer">Alpine Linux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a Linux distribution built around <a href="https://www.musl-libc.org/" target="_blank" rel="noopener noreferrer">musl libc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.busybox.net/" target="_blank" rel="noopener noreferrer">BusyBox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>musl-libc 和 glibc 是 c 语言标准库的不同实现。glibc 兼容性更好，musl-libc 优点是小也是为了嵌入式开发。</p> <p>为了部署应用建议选择 glibc，因为好多语言都是基于 glibc 编译构建的，兼容性更好。</p> <p>建议后端部署，还是选择 google distroless 吧。</p> <h2 id="entrypoint-和-cmd"><a href="#entrypoint-和-cmd" class="header-anchor">#</a> ENTRYPOINT 和 CMD</h2> <p><code>ENTRYPOINT</code> 的格式和 <code>RUN</code> 指令格式一样，分为 <code>exec</code> 格式和 <code>shell</code> 格式。</p> <p><code>ENTRYPOINT</code> 的目的和 <code>CMD</code> 一样，都是在指定容器启动程序及参数。<code>ENTRYPOINT</code> 在运行时也可以替代，不过比 <code>CMD</code> 要略显繁琐，需要通过 <code>docker run</code> 的参数 <code>--entrypoint</code> 来指定。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>当指定了 <code>ENTRYPOINT</code> 后，<code>CMD</code> 的含义就发生了改变，不再是直接的运行其命令，</p> <p>而是将 <code>CMD</code> 的内容作为参数传给 <code>ENTRYPOINT</code> 指令，换句话说实际执行时，将变为：ENTRYPOINT CMD</p></div> <p>那么有了 <code>CMD</code> 后，为什么还要有 <code>ENTRYPOINT</code> 呢？这种 <code>&lt;ENTRYPOINT&gt; &quot;&lt;CMD&gt;&quot;</code> 有什么好处么？让我们来看几个场景。</p> <p><code>ENTRYPOINT</code> + <code>CMD</code> = 默认容器命令参数</p> <p>推荐指定 <code>ENTRYPOINT</code> , 然后通过 cmd 来追加参数</p> <div class="language- extra-class"><pre class="language-text"><code>ENTRYPOINT [&quot;/docker-entrypoint.sh&quot;]
CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhangpanqin/mflyyou/edit/main/docs/devops/docker/README.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/9/19 上午10:33:24</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/mflyyou/devops/terraform/">
                Terraform
            </a>
            →
        </span></p></div> </main> <aside class="right-sidebar"> <div class="right-sidebar-toc-container" style="display:;"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">Docker</div> <hr> <div class="toc-box"><ul><li><a href="/mflyyou/devops/docker/#colima" class="toc-sidebar-link">colima</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/mflyyou/devops/docker/#docker-command" class="toc-sidebar-link">docker command</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/mflyyou/devops/docker/#镜像介绍" class="toc-sidebar-link">镜像介绍</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/mflyyou/devops/docker/#多阶段构建" class="toc-sidebar-link">多阶段构建</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/mflyyou/devops/docker/#基础镜像选择" class="toc-sidebar-link">基础镜像选择</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/docker/#google-distroless-image" class="toc-sidebar-link">Google distroless image</a></li><li class="toc-sidebar-sub-header"><a href="/mflyyou/devops/docker/#该不该选择-alpine-做为基础镜像" class="toc-sidebar-link">该不该选择 alpine 做为基础镜像？</a></li></ul></li><li><a href="/mflyyou/devops/docker/#entrypoint-和-cmd" class="toc-sidebar-link">ENTRYPOINT 和 CMD</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div> <div class="right-sidebar-toolbar"><div class="option-box"><img src="/mflyyou/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span></div> <div class="option-box"><img src="/mflyyou/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <!----> <div title="Terraform" class="option-box" style="padding-left:2px;text-align:center;"><a href="/mflyyou/devops/terraform/"><img src="/mflyyou/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div> </aside></div><div class="global-ui"><!----><!----></div></div>
    <script src="/mflyyou/assets/js/app.a8bf9193.js" defer></script><script src="/mflyyou/assets/js/4.527dd67c.js" defer></script><script src="/mflyyou/assets/js/2.40ff7517.js" defer></script><script src="/mflyyou/assets/js/51.89b2012e.js" defer></script><script src="/mflyyou/assets/js/13.5f8596a1.js" defer></script>
  </body>
</html>
